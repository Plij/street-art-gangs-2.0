<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="default">
	<title>Register</title>


	<!-- Stylesheets -->
	<link rel="stylesheet" href="font/sag/style.css">
	<link rel="stylesheet" href="css/animate.css">
	 <link rel="stylesheet" type="text/css" href="css/universal.css" />
	<link rel="stylesheet" href="css/signup.css">

</head>

<body id="signup" class="neutral">

		<div class="header">
				<h1>Sign Up</h1>
		</div>

		<div class="content">

			 <div class="form">
					<input type="text" class="input" placeholder="Name" id ="username">
					<input type="text" class="input" placeholder="Email"  id ="email">
					<input type="password" class="input" placeholder="Password" id ="password">
					<input type="password" class="input" placeholder="Password again" id ="rePassword">
					<select id="gang" name="gang" class="feedback-input">
						<option id="neutral">Choose Your Gang</option>
						<!--TODO: Get data from the server-->
						<option id="purple"  data-gang="1">Purple</option>
						<option id="greens"  data-gang="2">Green</option>
						<option id="blues" data-gang="3">Blue</option>
					</select>
			</div>

			<div class="btn btntxt">I'm ready <span class="icon-arrow-right-small"></span></div>

		</div>

		<!-- Scripts -->

		<script src='http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js'></script>
		<script src="js/scripts.js"></script>
		<script>

			//Animate.css
			$(document).ready(function(){
				$('h1').addClass('animated pulse');
				$('input, select').addClass('animated bounceInUp');
				$('.btn').addClass('animated bounceInUp');
			});

			//Change background depending on the gang
			$( "#gang" ).change(function () {
				var gang = $( "#gang option:selected" ).attr('id');
				switch (gang) {
					case 'purple':
						$('#signup').removeClass().addClass('purple')
						break;
					case 'greens':
						$('#signup').removeClass().addClass('green')
						break;
					case 'blues':
						$('#signup').removeClass().addClass('blue')
						break;
					default:
						$('#signup').removeClass().addClass('neutral')
				}
			}).change();

			//Form submission
			$('.btn.btntxt').one( "click", function() {
				//TODO: Validate.
				//TODO Check same password

				var endpoint = "http://vm0063.virtues.fi/authentication/";

				var username = $('#username').val();
				var email = $('#email').val();
				var password = $('#password').val();
				var rePassword = $('#rePassword').val();
				var gang = $( "#gang option:selected" ).data( "gang" );

				var attr = {
					username: username,
					email: email,
					password: password,
					gang: gang
				};

				$.post( endpoint, attr).done(function( data ) {
						var authorization = make_base_auth(username, password);
						localStorage.authorization=authorization;
						localStorage.color=data['color'];
						window.location.replace("home.html");
					}).fail(function( jqXHR, textStatus ) {
					//TODO fix this
						//alert("Error");
						window.location.replace("signup.html");
					});


			});
		</script>

</body>
</html>
