<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <title>Home</title>

  <!-- Launch icons -->
  <link rel="apple-touch-icon" href="img/icons/ios/icon.png" />
  <link rel="apple-touch-icon" sizes="72x72" href="img/icons/icon-72.png" />
  <link rel="apple-touch-icon" sizes="114x114" href="img/icons/icon@2x.png" />
  <link rel="apple-touch-icon" sizes="144x144" href="img/icons/icon-72@2x.png" />

  <!-- Stylesheets -->
  <link rel="stylesheet" href="css/animate.css">
  <link rel="stylesheet" type="text/css" href="css/normalize.css" />
  <link rel="stylesheet" type="text/css" href="css/icons.css" />
  <link rel="stylesheet" type="text/css" href="css/universal.css" />
  <link rel="stylesheet" type="text/css" href="css/home.css" />
  <link rel="stylesheet" href="css/liquid-slider.css">

   <!-- Modernizr.js needed for the Menu -->
  <script src="js/modernizr.custom.js"></script>
</head>

<body id="home">

    <div class="container">

      <ul id="gn-menu" class="gn-menu-main">
        <li class="gn-trigger">
          <a class="gn-icon gn-icon-menu icon-list-2"><span class="hide">Menu</span></a>
          <nav class="gn-menu-wrapper">
            <div class="gn-scroller">
              <ul class="gn-menu">
                <li><a class="gn-icon" href="profile.html"><span class="nav-icon icon-dude"></span>Profile</a></li>
                <li><a class="gn-icon" href="gang.html"><span class="nav-icon icon-dudes"></span>Gang</a></li>
                <li><a class="gn-icon" href="leaderboard.html"><span class="nav-icon icon-trophy"></span>Leaderboard</a></li>
                <li><a class="gn-icon" href="spray.html"><span class="nav-icon icon-config"></span>Tweaks</a></li>
              </ul>
            </div><!-- /gn-scroller -->
          </nav>
        </li>
        <li class="messages"><a href="chat.html">4<span class="icon-message-bubble"></a></li>
      </ul><!-- /gn-menu -->


          <div class="liquid-slider"  id="main-slider">
            <!-- Venue: Model
            <div class="venue">
              <p class="owner"><span class="blue-owns">Blue</span> gang owns</p>
              <div class="category icon-sun"></div>
              <h3 class="title">great outdoors</h2>
              <h1 class="location">Toripolliisi</h2>
            </div>
            -->
          </div>
          <!-- /liquid-slider -->



          <div class="arrows">
            <a id="to-left" class="icon-arrow-left-big" href="#left" data-liquidslider-ref="main-slider"></a>
            <a id="to-right" class="icon-arrow-right-big" href="#right" data-liquidslider-ref="main-slider"></a>
          </div><!-- /arrows -->

          <div id="start-to-spray">
            <a class="spray icon-droplet" href="spray-purple.html"></a>
          </div>



    </div><!-- /container -->

  <!-- Scripts -->
    <script src='http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js'></script>
    <script src="js/classie_menu.js"></script>
    <script src="js/gnmenu.js"></script>

    <script src="js/jquery.fittext.js"></script>
    <script src="js/jquery.touchSwipe.min.js"></script>
    <script src="js/jquery.liquid-slider-custom.min.js"></script>
    <script src="js/scripts.js"></script>
    <script>


      //Load venues or redirect
      jQuery(document).ready(function(){

      if (!localStorage.authorization||!localStorage.color||!localStorage.gangster) {
        window.location.replace("splash.html");
      } else {

        //Change color background depending on player's color
        var color = localStorage.color;
        $('body').removeClass().addClass(color)

        //Menu
        new gnMenu( document.getElementById( 'gn-menu' ) );

        //Animate.css
        jQuery(document).ready(function(){
          jQuery('#start-to-spray').addClass('animated pulse');
        });

        //Get Venues
        var authorization=localStorage.authorization;
        var endpoint = "http://vm0063.virtues.fi/venues/";
        $.ajax({
          type: "GET",
          url: endpoint,
          dataType: 'json',
          beforeSend: function (xhr) {
            xhr.setRequestHeader ("Authorization", authorization);
          }
        }).done(function( data ) {
        //TODO Populate venues
          for (var i = data.length - 1; i >= 0; i--) {
            var venue = $("<div>").addClass("venue");
            var owner = $("<p>").addClass("owner");
            var gang = data[i].gang;
            if (gang != null) {
              $("<span>").addClass(gang+"-owns").text(gang).appendTo(owner);
              owner.append(" gang owns it!").appendTo(venue);
            } else {
              owner.append("This place is still clean!").appendTo(venue); //TODO change with something better
            }

            $("<div>").addClass("category").addClass(getCategoryClass(data[i].category)).appendTo(venue);
            $("<h3>").addClass("title").text(getCategory(data[i].category)).appendTo(venue);
            $("<h1>").addClass("location").text(data[i].name).appendTo(venue);
            $('#main-slider').append(venue);
          };

          // Venue slider
          $('#main-slider').liquidSlider({
              hashLinking:false,
              crossLinks:true,
              includeTitle:true,
              mobileNavigation:false,
              firstPanelToLoad:1,
              autoHeight:false,
              minHeight: 0,
              swipe: true,
              hideArrowsWhenMobile: true,
              dynamicArrows: false,
              slideEaseFunction:'easeInOutCubic',
              slideEaseDuration:400,
              heightEaseDuration:800

            // animateIn:"slideInLeft",
            // animateOut:"slideOutLeft"
          });

          jQuery("h1.location").fitText(1.6);
          jQuery(".category").fitText(.6);
          jQuery("h3.title").fitText(1.5);

        }).fail(function( jqXHR, textStatus ) {
        //TODO fix this
          alert("Error: something went wrong while loading the venues");
        });
      }
    });



      var getCategory = function (val) {

        switch (val) {
          case 'Ou':
            return 'Great Outdoors';
            break;
          case 'Ni':
            return 'Nightlife Spots';
            break;
          case 'Ar':
            return 'Arts & Entertainment';
            break;
          case 'Ed':
            return 'Education';
            break;
          case 'Fo':
            return 'Food';
            break;
          case 'Ot':
            return 'Other Places';
            break;
          case 'Sh':
            return 'Shops & Services';
            break;
          case 'Tr':
            return 'Travel & Transport';
            break;
        }
      }

      var getCategoryClass = function (val) {

        switch (val) {
          case 'Ou':
            return 'icon-sun';
            break;
          case 'Ni':
            return 'icon-sun';
            break;
          case 'Ar':
            return 'icon-ticket';
            break;
          case 'Ed':
            return 'icon-graduation';
            break;
          case 'Fo':
            return 'icon-food';
            break;
          case 'Ot':
            return 'icon-office';
            break;
          case 'Sh':
            return 'icon-cart';
            break;
          case 'Tr':
            return 'icon-rocket';
            break;
        }
      }



    </script>

</body>
</html>
